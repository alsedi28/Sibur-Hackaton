var start_date = "2017-01-12 13:47:00";

var ctx_one = document.getElementById("graph_one");
var ctx_two = document.getElementById("graph_two");
var ctx_three = document.getElementById("graph_three");

var ctx_radar = document.getElementById("graph_radar");

var graph_radar = new Chart(ctx_radar, {
    type: 'radar',
    data: {
        labels: ['Top1', 'Top2', 'Top3', 'Top4', 'Top5'],
        datasets: [{
            data: [20, 10, 4, 2, 34]
        }]
    },
    options: {
        legend: {
            display: false
        },
        animation: {
            duration: 0
        },
        scale: {
            ticks: {
              min: 0,
              //max: 50,
              //stepSize: 10,
              beginAtZero: true
            },
            pointLabels: { fontSize:25 }
          }
    }
});


var x1Data = ['2017-01-12 13:46:50',
'2017-01-12 13:47:00',
'2017-01-12 13:47:10',
'2017-01-12 13:47:20',
'2017-01-12 13:47:30',
'2017-01-12 13:47:40',
'2017-01-12 13:47:50',
'2017-01-12 13:48:00',
'2017-01-12 13:48:10',
'2017-01-12 13:48:20',
'2017-01-12 13:48:30',
'2017-01-12 13:48:40',
'2017-01-12 13:48:50',
'2017-01-12 13:49:00',
'2017-01-12 13:49:10',
'2017-01-12 13:49:20',
'2017-01-12 13:49:30',
'2017-01-12 13:49:40',
'2017-01-12 13:49:50',
'2017-01-12 13:50:00',
'2017-01-12 13:50:10',
'2017-01-12 13:50:20',
'2017-01-12 13:50:30',
'2017-01-12 13:50:40',
'2017-01-12 13:50:50',
'2017-01-12 13:51:00',
'2017-01-12 13:51:10',
'2017-01-12 13:51:20',
'2017-01-12 13:51:30',
'2017-01-12 13:51:40',
'2017-01-12 13:51:50',
'2017-01-12 13:52:00',
'2017-01-12 13:52:10',
'2017-01-12 13:52:20',
'2017-01-12 13:52:30',
'2017-01-12 13:52:40',
'2017-01-12 13:52:50',
'2017-01-12 13:53:00',
'2017-01-12 13:53:10',
'2017-01-12 13:53:20',
'2017-01-12 13:53:30',
'2017-01-12 13:53:40',
'2017-01-12 13:53:50',
'2017-01-12 13:54:00',
'2017-01-12 13:54:10',
'2017-01-12 13:54:20',
'2017-01-12 13:54:30',
'2017-01-12 13:54:40',
'2017-01-12 13:54:50',
'2017-01-12 13:55:00',
'2017-01-12 13:55:10',
'2017-01-12 13:55:20',
'2017-01-12 13:55:30',
'2017-01-12 13:55:40',
'2017-01-12 13:55:50',
'2017-01-12 13:56:00',
'2017-01-12 13:56:10',
'2017-01-12 13:56:20',
'2017-01-12 13:56:30',
'2017-01-12 13:56:40',
'2017-01-12 13:56:50',
'2017-01-12 13:57:00',
'2017-01-12 13:57:10',
'2017-01-12 13:57:20',
'2017-01-12 13:57:30',
'2017-01-12 13:57:40',
'2017-01-12 13:57:50',
'2017-01-12 13:58:00',
'2017-01-12 13:58:10',
'2017-01-12 13:58:20',
'2017-01-12 13:58:30',
'2017-01-12 13:58:40',
'2017-01-12 13:58:50',
'2017-01-12 13:59:00',
'2017-01-12 13:59:10',
'2017-01-12 13:59:20',
'2017-01-12 13:59:30',
'2017-01-12 13:59:40',
'2017-01-12 13:59:50',
'2017-01-12 14:00:00',
'2017-01-12 14:00:10',
'2017-01-12 14:00:20',
'2017-01-12 14:00:30',
'2017-01-12 14:00:40',
'2017-01-12 14:00:50',
'2017-01-12 14:01:00',
'2017-01-12 14:01:10',
'2017-01-12 14:01:20',
'2017-01-12 14:01:30',
'2017-01-12 14:01:40',
'2017-01-12 14:01:50',
'2017-01-12 14:02:00',
'2017-01-12 14:02:10',
'2017-01-12 14:02:20',
'2017-01-12 14:02:30',
'2017-01-12 14:02:40',
'2017-01-12 14:02:50',
'2017-01-12 14:03:00',
'2017-01-12 14:03:10',
'2017-01-12 14:03:20',
'2017-01-12 14:03:30',
'2017-01-12 14:03:40',
'2017-01-12 14:03:50',
'2017-01-12 14:04:00',
'2017-01-12 14:04:10',
'2017-01-12 14:04:20',
'2017-01-12 14:04:30',
'2017-01-12 14:04:40',
'2017-01-12 14:04:50',
'2017-01-12 14:05:00',
'2017-01-12 14:05:10',
'2017-01-12 14:05:20',
'2017-01-12 14:05:30',
'2017-01-12 14:05:40',
'2017-01-12 14:05:50',
'2017-01-12 14:06:00',
'2017-01-12 14:06:10',
'2017-01-12 14:06:20',
'2017-01-12 14:06:30',
'2017-01-12 14:06:40'];

var y1Data = [8.720000267,
8.710000037999999,
8.68999958,
8.68999958,
8.699999809,
8.659999847,
8.670000076,
8.679999352000001,
8.649999618999999,
8.670000076,
8.670000076,
8.649999618999999,
8.670000076,
8.63999939,
8.649999618999999,
8.630000114,
8.68999958,
8.68999958,
8.699999809,
8.679999352000001,
8.649999618999999,
8.649999618999999,
8.649999618999999,
8.679999352000001,
8.679999352000001,
8.679999352000001,
8.679999352000001,
8.68999958,
8.679999352000001,
8.68999958,
8.710000037999999,
8.739999771,
8.75,
8.720000267,
8.75,
8.720000267,
8.729999542,
8.760000229,
8.760000229,
8.729999542,
8.729999542,
8.720000267,
8.75,
8.779999733,
8.769999504,
8.789999962000001,
8.769999504,
8.769999504,
8.75,
8.769999504,
8.769999504,
8.769999504,
8.739999771,
8.75,
8.679999352000001,
8.590000153,
8.720000267,
8.779999733,
8.75,
8.720000267,
8.720000267,
8.739999771,
8.75,
8.739999771,
8.729999542,
8.720000267,
8.699999809,
8.699999809,
8.68999958,
8.720000267,
8.720000267,
8.729999542,
8.729999542,
8.75,
8.75,
8.75,
8.729999542,
8.720000267,
8.68999958,
8.710000037999999,
8.699999809,
8.729999542,
8.720000267,
8.760000229,
8.720000267,
8.68999958,
8.68999958,
8.68999958,
8.699999809,
8.68999958,
8.63999939,
8.68999958,
8.68999958,
8.710000037999999,
8.699999809,
8.699999809,
8.710000037999999,
8.729999542,
8.679999352000001,
8.679999352000001,
8.68999958,
8.670000076,
8.68999958,
8.679999352000001,
8.68999958,
8.68999958,
8.679999352000001,
8.679999352000001,
8.68999958,
8.68999958,
8.68999958,
8.679999352000001,
8.679999352000001,
8.679999352000001,
8.679999352000001,
8.710000037999999,
8.68999958,
8.720000267,
8.699999809,
8.729999542];
var x2Data = ['2017-01-12 13:46:50',
'2017-01-12 13:47:00',
'2017-01-12 13:47:10',
'2017-01-12 13:47:20',
'2017-01-12 13:47:30',
'2017-01-12 13:47:40',
'2017-01-12 13:47:50',
'2017-01-12 13:48:00',
'2017-01-12 13:48:10',
'2017-01-12 13:48:20',
'2017-01-12 13:48:30',
'2017-01-12 13:48:40',
'2017-01-12 13:48:50',
'2017-01-12 13:49:00',
'2017-01-12 13:49:10',
'2017-01-12 13:49:20',
'2017-01-12 13:49:30',
'2017-01-12 13:49:40',
'2017-01-12 13:49:50',
'2017-01-12 13:50:00',
'2017-01-12 13:50:10',
'2017-01-12 13:50:20',
'2017-01-12 13:50:30',
'2017-01-12 13:50:40',
'2017-01-12 13:50:50',
'2017-01-12 13:51:00',
'2017-01-12 13:51:10',
'2017-01-12 13:51:20',
'2017-01-12 13:51:30',
'2017-01-12 13:51:40',
'2017-01-12 13:51:50',
'2017-01-12 13:52:00',
'2017-01-12 13:52:10',
'2017-01-12 13:52:20',
'2017-01-12 13:52:30',
'2017-01-12 13:52:40',
'2017-01-12 13:52:50',
'2017-01-12 13:53:00',
'2017-01-12 13:53:10',
'2017-01-12 13:53:20',
'2017-01-12 13:53:30',
'2017-01-12 13:53:40',
'2017-01-12 13:53:50',
'2017-01-12 13:54:00',
'2017-01-12 13:54:10',
'2017-01-12 13:54:20',
'2017-01-12 13:54:30',
'2017-01-12 13:54:40',
'2017-01-12 13:54:50',
'2017-01-12 13:55:00',
'2017-01-12 13:55:10',
'2017-01-12 13:55:20',
'2017-01-12 13:55:30',
'2017-01-12 13:55:40',
'2017-01-12 13:55:50',
'2017-01-12 13:56:00',
'2017-01-12 13:56:10',
'2017-01-12 13:56:20',
'2017-01-12 13:56:30',
'2017-01-12 13:56:40',
'2017-01-12 13:56:50',
'2017-01-12 13:57:00',
'2017-01-12 13:57:10',
'2017-01-12 13:57:20',
'2017-01-12 13:57:30',
'2017-01-12 13:57:40',
'2017-01-12 13:57:50',
'2017-01-12 13:58:00',
'2017-01-12 13:58:10',
'2017-01-12 13:58:20',
'2017-01-12 13:58:30',
'2017-01-12 13:58:40',
'2017-01-12 13:58:50',
'2017-01-12 13:59:00',
'2017-01-12 13:59:10',
'2017-01-12 13:59:20',
'2017-01-12 13:59:30',
'2017-01-12 13:59:40',
'2017-01-12 13:59:50',
'2017-01-12 14:00:00',
'2017-01-12 14:00:10',
'2017-01-12 14:00:20',
'2017-01-12 14:00:30',
'2017-01-12 14:00:40',
'2017-01-12 14:00:50',
'2017-01-12 14:01:00',
'2017-01-12 14:01:10',
'2017-01-12 14:01:20',
'2017-01-12 14:01:30',
'2017-01-12 14:01:40',
'2017-01-12 14:01:50',
'2017-01-12 14:02:00',
'2017-01-12 14:02:10',
'2017-01-12 14:02:20',
'2017-01-12 14:02:30',
'2017-01-12 14:02:40',
'2017-01-12 14:02:50',
'2017-01-12 14:03:00',
'2017-01-12 14:03:10',
'2017-01-12 14:03:20',
'2017-01-12 14:03:30',
'2017-01-12 14:03:40',
'2017-01-12 14:03:50',
'2017-01-12 14:04:00',
'2017-01-12 14:04:10',
'2017-01-12 14:04:20',
'2017-01-12 14:04:30',
'2017-01-12 14:04:40',
'2017-01-12 14:04:50',
'2017-01-12 14:05:00',
'2017-01-12 14:05:10',
'2017-01-12 14:05:20',
'2017-01-12 14:05:30',
'2017-01-12 14:05:40',
'2017-01-12 14:05:50',
'2017-01-12 14:06:00',
'2017-01-12 14:06:10',
'2017-01-12 14:06:20',
'2017-01-12 14:06:30',
'2017-01-12 14:06:40'];

var y2Data = [327.6000061000001,
326.1000061000001,
320.7000122,
325.5,
322.8000183000001,
327.6000061000001,
320.8999939,
323.7000122,
327.1000061000001,
327.6000061000001,
323.1000061000001,
328.6000061000001,
324.3000183000001,
328.8000183000001,
326.7000122,
324.8999939,
328.2000122,
327.6000061000001,
322.3999939,
326.6000061000001,
323.7000122,
325.2000122,
324.8999939,
325.8000183000001,
327.0,
326.3999939,
327.3000183000001,
326.7000122,
328.8000183000001,
329.8000183000001,
326.3999939,
325.2000122,
326.1000061000001,
324.0,
329.1000061000001,
327.3000183000001,
326.1000061000001,
326.1000061000001,
327.0,
323.7000122,
322.8000183000001,
327.3000183000001,
329.3999939,
330.3000183000001,
326.3999939,
328.5,
327.3000183000001,
324.0,
325.8000183000001,
327.6000061000001,
324.0,
322.8000183000001,
324.8999939,
327.0,
324.3000183000001,
324.3000183000001,
325.8000183000001,
326.1000061000001,
324.6000061000001,
325.8000183000001,
326.1000061000001,
323.3999939,
321.8999939,
324.8999939,
321.6000061000001,
325.8000183000001,
323.1000061000001,
323.7000122,
327.3000183000001,
332.5,
324.8999939,
326.1000061000001,
329.1000061000001,
326.8999939,
328.8000183000001,
324.6000061000001,
325.8000183000001,
323.8000183000001,
324.3000183000001,
326.1000061000001,
327.8999939,
327.3000183000001,
325.2000122,
328.8000183000001,
321.6000061000001,
327.0,
324.0,
328.6000061000001,
329.1000061000001,
329.3999939,
326.7000122,
324.8999939,
327.8999939,
326.7000122,
323.1000061000001,
326.1000061000001,
327.0,
321.8999939,
326.1000061000001,
326.7000122,
322.2000122,
328.2000122,
327.3000183000001,
323.1000061000001,
323.7000122,
329.8000183000001,
321.8000183000001,
324.0,
326.7000122,
326.6000061000001,
326.6000061000001,
327.6000061000001,
324.0,
324.0,
325.2000122,
319.5,
325.2000122,
323.1000061000001,
324.6000061000001,
326.3999939];
var x3Data = ['2017-01-12 13:46:50',
'2017-01-12 13:47:00',
'2017-01-12 13:47:10',
'2017-01-12 13:47:20',
'2017-01-12 13:47:30',
'2017-01-12 13:47:40',
'2017-01-12 13:47:50',
'2017-01-12 13:48:00',
'2017-01-12 13:48:10',
'2017-01-12 13:48:20',
'2017-01-12 13:48:30',
'2017-01-12 13:48:40',
'2017-01-12 13:48:50',
'2017-01-12 13:49:00',
'2017-01-12 13:49:10',
'2017-01-12 13:49:20',
'2017-01-12 13:49:30',
'2017-01-12 13:49:40',
'2017-01-12 13:49:50',
'2017-01-12 13:50:00',
'2017-01-12 13:50:10',
'2017-01-12 13:50:20',
'2017-01-12 13:50:30',
'2017-01-12 13:50:40',
'2017-01-12 13:50:50',
'2017-01-12 13:51:00',
'2017-01-12 13:51:10',
'2017-01-12 13:51:20',
'2017-01-12 13:51:30',
'2017-01-12 13:51:40',
'2017-01-12 13:51:50',
'2017-01-12 13:52:00',
'2017-01-12 13:52:10',
'2017-01-12 13:52:20',
'2017-01-12 13:52:30',
'2017-01-12 13:52:40',
'2017-01-12 13:52:50',
'2017-01-12 13:53:00',
'2017-01-12 13:53:10',
'2017-01-12 13:53:20',
'2017-01-12 13:53:30',
'2017-01-12 13:53:40',
'2017-01-12 13:53:50',
'2017-01-12 13:54:00',
'2017-01-12 13:54:10',
'2017-01-12 13:54:20',
'2017-01-12 13:54:30',
'2017-01-12 13:54:40',
'2017-01-12 13:54:50',
'2017-01-12 13:55:00',
'2017-01-12 13:55:10',
'2017-01-12 13:55:20',
'2017-01-12 13:55:30',
'2017-01-12 13:55:40',
'2017-01-12 13:55:50',
'2017-01-12 13:56:00',
'2017-01-12 13:56:10',
'2017-01-12 13:56:20',
'2017-01-12 13:56:30',
'2017-01-12 13:56:40',
'2017-01-12 13:56:50',
'2017-01-12 13:57:00',
'2017-01-12 13:57:10',
'2017-01-12 13:57:20',
'2017-01-12 13:57:30',
'2017-01-12 13:57:40',
'2017-01-12 13:57:50',
'2017-01-12 13:58:00',
'2017-01-12 13:58:10',
'2017-01-12 13:58:20',
'2017-01-12 13:58:30',
'2017-01-12 13:58:40',
'2017-01-12 13:58:50',
'2017-01-12 13:59:00',
'2017-01-12 13:59:10',
'2017-01-12 13:59:20',
'2017-01-12 13:59:30',
'2017-01-12 13:59:40',
'2017-01-12 13:59:50',
'2017-01-12 14:00:00',
'2017-01-12 14:00:10',
'2017-01-12 14:00:20',
'2017-01-12 14:00:30',
'2017-01-12 14:00:40',
'2017-01-12 14:00:50',
'2017-01-12 14:01:00',
'2017-01-12 14:01:10',
'2017-01-12 14:01:20',
'2017-01-12 14:01:30',
'2017-01-12 14:01:40',
'2017-01-12 14:01:50',
'2017-01-12 14:02:00',
'2017-01-12 14:02:10',
'2017-01-12 14:02:20',
'2017-01-12 14:02:30',
'2017-01-12 14:02:40',
'2017-01-12 14:02:50',
'2017-01-12 14:03:00',
'2017-01-12 14:03:10',
'2017-01-12 14:03:20',
'2017-01-12 14:03:30',
'2017-01-12 14:03:40',
'2017-01-12 14:03:50',
'2017-01-12 14:04:00',
'2017-01-12 14:04:10',
'2017-01-12 14:04:20',
'2017-01-12 14:04:30',
'2017-01-12 14:04:40',
'2017-01-12 14:04:50',
'2017-01-12 14:05:00',
'2017-01-12 14:05:10',
'2017-01-12 14:05:20',
'2017-01-12 14:05:30',
'2017-01-12 14:05:40',
'2017-01-12 14:05:50',
'2017-01-12 14:06:00',
'2017-01-12 14:06:10',
'2017-01-12 14:06:20',
'2017-01-12 14:06:30',
'2017-01-12 14:06:40'];
var y3Data = [38.02000046,
38.00999832,
37.98999786,
37.97999954,
37.96999741,
37.96999741,
37.97999954,
37.97999954,
37.98999786,
37.97999954,
37.98999786,
37.97999954,
37.98999786,
37.98999786,
37.98999786,
37.97999954,
37.97999954,
37.97999954,
37.98999786,
37.97999954,
38.0,
38.00999832,
38.02000046,
38.04999924,
38.04999924,
38.06999969,
38.06999969,
38.06999969,
38.05999756,
38.04000092,
38.02999878,
38.02000046,
38.0,
37.97999954,
37.97999954,
37.96999741,
37.96999741,
37.96999741,
37.97999954,
37.98999786,
37.97999954,
37.97999954,
37.96999741,
37.96999741,
37.96999741,
37.96999741,
37.97999954,
38.0,
38.02000046,
38.02000046,
38.00999832,
38.00999832,
38.0,
37.98999786,
37.97999954,
37.96999741,
37.95999908,
37.96999741,
37.95999908,
37.95000076,
37.95999908,
37.96999741,
37.97999954,
38.00999832,
38.02999878,
38.04000092,
38.02999878,
38.04999924,
38.05999756,
38.06999969,
38.04999924,
38.05999756,
38.09000015,
38.11999893,
38.13999939,
38.15999985,
38.18999863,
38.20999908,
38.23999786,
38.25,
38.27000046,
38.27999878,
38.29000092,
38.27000046,
38.25999832,
38.25999832,
38.23999786,
38.20999908,
38.18000031,
38.15999985,
38.12999725,
38.11999893,
38.11000061,
38.09999847,
38.09999847,
38.09000015,
38.09000015,
38.09000015,
38.09999847,
38.09000015,
38.09999847,
38.09999847,
38.11000061,
38.11999893,
38.11000061,
38.11000061,
38.12999725,
38.12999725,
38.12999725,
38.11999893,
38.11999893,
38.11000061,
38.11000061,
38.11000061,
38.09999847,
38.09999847,
38.09000015,
38.09000015,
38.09000015,
38.09999847];

var graph_one = create_line_graph(ctx_one, "Дата", "YYY", x1Data, y1Data);
var graph_two = create_line_graph(ctx_two, "Дата", "YYY", x2Data, y2Data);
var graph_three = create_line_graph(ctx_three, "Дата", "YYY", x3Data, y3Data);

setInterval(function() {
    var request_date = new Date(start_date);
    console.log(request_date);
    request_date.setSeconds(request_date.getSeconds() + 10);

    var day = request_date.getDate();
    var monthIndex = request_date.getMonth() + 1;
    var year = request_date.getFullYear();
    var hours = request_date.getHours();
    var minutes = request_date.getMinutes();
    var seconds = request_date.getSeconds();

    start_date = year + '-' + monthIndex + '-' + day + ' ' + hours + ':' + minutes + ':' + seconds;

    console.log(start_date);

    $.ajax({
            type: 'POST',
            url: 'api/data',
            data: { 'date' : start_date },
            success: function (data) {
                change_data_line_graph(graph_one, start_date, data.top1);
                change_data_line_graph(graph_two, start_date, data.top2);
                change_data_line_graph(graph_three, start_date, data.top3);

                change_data_radar_graph(graph_radar, [data.top1, data.top2, data.top3, data.top4, data.top5]);

                $('#speedometer_graph').val(data.proba * 100).trigger('change');
            }
        });
}, 10000);

function create_line_graph(ctx_obj, x_title, y_title, x_data, y_data) {
    return new Chart(ctx_obj, {
        type: 'line',
        data: {
            labels: x_data,
            datasets: [{
                data: y_data,
                backgroundColor: false,
                pointRadius: 0,
                borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            legend: {
                display: false
            },
            animation: {
                duration: 0,
            },
            scales: {
                yAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: y_title
                    }
                }],
                xAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: x_title
                    }
                }]
            }
        }
    });
}

function change_data_line_graph(graph_obj, value_x, value_y) {
    graph_obj.data.labels.push(value_x);
    graph_obj.data.datasets.forEach(function(dataset){
        dataset.data.push(value_y);
    });

    graph_obj.data.labels.shift();
    graph_obj.data.datasets.forEach(function(dataset){
        dataset.data.shift();
    });
    graph_obj.update();
}

function change_data_radar_graph(graph_obj, value_arr) {
    graph_obj.data.datasets.forEach(function(dataset){
        dataset.data = value_arr;
    });

    graph_obj.update();
}

$("#speedometer_graph").myfunc({
    /**Max value of the meter*/
    maxVal              : 100,

    /**Division value of the meter*/
    divFact             : 10,

    /**more than this leval, color will be red*/
    dangerLevel         : 80,

    /**reading begins angle*/
    initDeg             : 0,

    /**total angle of the meter reading*/
    maxDeg              : 180,

    /**radius of the meter circle*/
    edgeRadius          : 150,

    /**speed nobe height*/
    speedNobeH          : 4,

    /**speed nobe width*/
    speedoNobeW         : 95,

    /**speed nobe left position*/
    speedoNobeL         : 13,

    /**radius of indicators position*/
    indicatorRadius     : 125,

    /**radius of numbers position*/
    indicatorNumbRadius : 90,

    /**speedo-meter current value cont*/
    speedPositionTxtWH  : 80,

    /**indicator nob width*/
    nobW                : 20,

    /**indicator nob height*/
    nobH                : 4,

    /**indicator number width*/
    numbW               : 30,

    /**indicator number height*/
    numbH               : 16,

    /**indicator mid nob width*/
    midNobW             : 10,

    /**indicator mid nob height*/
    midNobH             : 3,

    /**no of small div between main div*/
    noOfSmallDiv        : 2,

    /**type of event listener*/
    eventListenerType   : 'change',

    /**Center value multiplier e.g. 1 x 1000 RPM*/
    multiplier          : 1,

    /**Label on guage Face*/
    gagueLabel    : ''
});
